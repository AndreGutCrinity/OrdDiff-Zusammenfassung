\section{Analytical methods for linear systems}
\noindent\rule[\linienAbstand]{\linewidth}{\linienDickeDick}
By the definition given above, by a system of ODE’s we mean the following system of explicit firstoder ODE’s:
\begin{equation}
  \begin{matrix}
    \dot{x}_1 & = & f_1(t, x_1, ..., x_n)\\
    \vdots  &  & \vdots \\
    \dot{x}_n & = & f_n(t, x_1, ..., x_n)
  \end{matrix}
\end{equation}

\subsection{Overview}
\noindent\rule[\linienAbstand]{\linewidth}{\linienDicke}
A system of linear first-order ODE’s has the form
\begin{equation}
  \begin{matrix}
    \dot{x}_1 & = & a_{11}(t)x_1 + ... + a_{1n}(t)x_n + b_1 (t)\\
    \vdots  &  & \vdots \\
    \dot{x}_n & = & a_{n1}(t)x_1 + ... + a_{nn}(t)x_n + b_n (t)
  \end{matrix}
\end{equation}
or in matrix-vector notation
\begin{equation}
  \dot{\mathbf{x}} = A(t)\mathbf{x}+\mathbf{b}t
\end{equation}
The general solution of the inhomogeneous system is the sum
\begin{equation}
  \mathbf{x} = \mathbf{x}_h+ \mathbf{x}_s
\end{equation}
where $x_h$ is the general solution of the homogeneous system and $x_s$ any special solution of the inhomogeneous system.\\

The set of solutions of the homogeneous system is an n-dimensional vector space. This is equivalent to the following two statements:\\
 - Any linear combination of solutions is again a solution, i.e. if $x_1$ and $x_2$ are solutions, then $C_1x_1 + C_2x_2$ is also a solution for any $C_1, C_2 \in \mathbb{R}$\\
 - There exist precisely $n$ linearly independent solution $x_1, . . . , x_n$. Such a set $\{x_1, . . . , x_n\}$ of linearly independent solutions is also called a \emph{fundamental system of solutions}. Algebraically, a fundamental system thus is a basis of the vector space of solutions.\\

\subsection{Homogeneous linear systems}
\noindent\rule[\linienAbstand]{\linewidth}{\linienDicke}
Since in the scalar case the solution of a homogeneous linear ODE is given by $x = e^{at}$, we try in the vectorial case an ansatz of the form
\begin{equation}
  \mathbf{x} = e^{\lambda t} \cdot \mathbf{c} =
  \begin{pmatrix}
    e^{\lambda t}c_1\\
    \vdots\\
    e^{\lambda t}c_n
  \end{pmatrix}
\end{equation}
Plugging the ansatz into the ODE leads to $e^{\lambda t}\lambda \mathbf{c} = e^{\lambda t} A\mathbf{c}$ and we thus get for $\lambda$ and $\mathbf{c}$ the equation
\begin{equation}
  A\mathbf{c} = \lambda \mathbf{c}
\end{equation}
This precisely means that $\mathbf{c}$ is an \emph{eigenvector} of $A$ to the \emph{eigenvalue} $\lambda$.
We destinguish between the following cases for $\lambda$\\

\textbf{Real eigenvalues}\\
If all eigenvalues of $A$ are real and $A$ has $n$ linear independent eigenvectors then the general solution is a linear combination of
\begin{equation}
  \mathbf{x}(t) = e^{\lambda t} \cdot \mathbf{c}
\end{equation}

Example: We compute the general solution of the homogeneous system
\begin{equation}
  \begin{split}
    \dot{x}_1 &= 2x_1 - x_2\\
    \dot{x}_2 &= -x_1 + 2x_2
  \end{split}
\end{equation}

or in the form $\dot{\mathbf{x}} = A\mathbf{x}$ with
\begin{equation}
  \mathbf{x}(t) = \begin{pmatrix}
    x_1(t)\\
    x_2(t)
  \end{pmatrix}
  , \;\; A = \begin{pmatrix}
      2 & -1\\
      -1 & 2
  \end{pmatrix}
\end{equation}

The matrix $A$ has the eigenvalues $\lambda_1 = 1, \lambda_2 = 3$ with corresponding eigenvectors $v_1 = \binom{1}{1}, v_2 = \binom{1}{-1}$. Hence the general solution $\mathbf{x}(t)$ of the homogeneous system is
\begin{equation}
  \mathbf{x}(t) = \begin{pmatrix}
    x_1(t)\\
    x_2(t)
  \end{pmatrix} = C_1 e^t \begin{pmatrix} 1 \\ 1 \end{pmatrix} +
  C_2 e^{3t} \begin{pmatrix} 1 \\ -1 \end{pmatrix}
\end{equation}

\textbf{Complex eigenvalues}\\
If there is at least one pair of complex conjugate eigenvalues and $A$ has $n$ linear independent eigenvectors then the general (complex) solution is a linear combination of $\mathbf{x} = e^{\lambda t}\cdot \mathbf{c}$. Real and complex parts of complex solutions are real
solutions


If $\lambda = \mu + j\nu$ is a simple complex eigenvalue of $A$ and $\mathbf{c} = \mathbf{a} + j\mathbf{b}$ a corresponding complex eigenvector of $A$, then from the complex solution
\begin{equation}
  \mathbf{x}(t) = e^{\lambda t} \mathbf{c} = e^{(\mu + j\nu)t} (\mathbf{a} + j\mathbf{b})
\end{equation}
we get two linearly independent real solutions by separating the complex solution into real and imaginary parts:
\begin{equation}
  \begin{split}
    \mathbf{z}_1(t) &= \textup{Re}(e^{\lambda t} \mathbf{c}) = e^{\mu t}(\mathbf{a} \; \textup{cos}(\nu t) - \mathbf{b} \; \textup{sin}(\nu t))\\
    \mathbf{z}_2(t) &= \textup{Im}(e^{\lambda t} \mathbf{c}) = e^{\mu t}(\mathbf{a} \; \textup{sin}(\nu t) + \mathbf{b} \; \textup{cos}(\nu t))
  \end{split}
\end{equation}
The complex conjugate of $\lambda$, namely $c = a - jb$ does not have to be considered because it would again lead to the same solutions.\\
The solution of the linear system is then $x = z_1 + z_2$\\

Example: We compute the general solution of a homogeneous system of ODE's where the matrix $A$ is
\begin{equation}
  A =
  \begin{pmatrix}
    3 & -2\\
    4 & -1
  \end{pmatrix}
\end{equation}
The eigenvalues of $A$ are $\lambda_{1, 2} = \color{cyan}1\color{black} \pm \color{violet}2\color{black}j$, with eigenvectors $\nu_{1,2} = \begin{pmatrix}\color{red} 1 \pm j \\ \color{red}2\color{black}\end{pmatrix}$.
\begin{equation}
  \mathbf{x} = C_1e^{\color{cyan}1\color{black}t} \begin{pmatrix}
  \color{red}1\color{black}\textup{cos}(\color{violet}2\color{black}t) -
  \color{red}1\color{black}\textup{sin}(\color{violet}2\color{black}t)\\
  \color{red}2\color{black}\textup{cos}(\color{violet}2\color{black}t) -
  \color{lightgray}0\textup{sin}(2t)\color{black} \end{pmatrix} +
  C_2 e^{\color{cyan}1\color{black}t} \begin{pmatrix}
  \color{red}1\color{black}\textup{sin}(\color{violet}2\color{black}t) +
  \color{red}1\color{black}\textup{cos}(\color{violet}2\color{black}t)\\
  \color{red}2\color{black}\textup{sin}(\color{violet}2\color{black}t) +
  \color{lightgray}0\textup{cos}(2t)\color{black}\end{pmatrix}
\end{equation}

\textbf{Polynomial expressions}\\
If $A$ has multiple eigenvalues and less than $n$ linear independent eigenvectors (More eigenvalues than eigenvectors), then not all solutions are of the form $\mathbf{x}(t) = e^{\lambda t} \mathbf{c}$. Additional solutions involve polynomial expressions. These polynomials are of the form\\
\begin{equation}
  \begin{split}
    p_0(t) &= e^{\lambda t} \mathbf{v}_1\\
    p_1(t) &= e^{\lambda t} (t\mathbf{v}_1 + \mathbf{v}_2)\\
    p_2(t) &= e^{\lambda t} (t^2\mathbf{v}_1 + 2t\mathbf{v}_2 + 2\mathbf{v}_3)
  \end{split}
\end{equation}

Example: The only eigenvalue of the matrix $A = \begin{pmatrix} 2 & 1 \\ 0 & 2 \end{pmatrix}$ is $\lambda = 2$, with the single (linearly
independent) eigenvector $\mathbf{v} = \binom{1}{0}$. Let $\mathbf{v}_1 = \mathbf{v}$\\
To find a generalized eigenvector $\mathbf{v}_2$, we solve the equation
\begin{equation}
  (A - \lambda E_n)\mathbf{v}_2 = \mathbf{v}_1
\end{equation}
\begin{equation}
  \begin{split}
    \left(\begin{pmatrix} 2 & 1 \\ 0 & 2 \end{pmatrix} -
    \begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix} \right) \mathbf{v}_2 =&
    \begin{pmatrix} 1 \\ 0 \end{pmatrix}\\
    \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix} \mathbf{v}_2 =&
    \begin{pmatrix} 1 \\ 0 \end{pmatrix}\\
    \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} =&
    \begin{pmatrix} 1 \\ 0 \end{pmatrix}
  \end{split}
\end{equation}
And therefore
\begin{equation}
  \mathbf{p}_1(t) = t\mathbf{v}_1 + \mathbf{v}_2 = t
  \begin{pmatrix} 1 \\ 0\end{pmatrix} +
  \begin{pmatrix} 0 \\ 1  \end{pmatrix} =
  \begin{pmatrix} t \\ 1 \end{pmatrix}
\end{equation}

The general solution therefore is
\begin{equation}
  \begin{split}
    \mathbf{x}(t) =& C_1 e^{2t} \begin{pmatrix} 1 \\ 0\end{pmatrix} +
    C_2 e^{2t} \begin{pmatrix} t \\ 1 \end{pmatrix}\\
    \mathbf{x}(t) =& \begin{pmatrix} C_1 e^{2t} + C_2 e^{2t}\\
    C_2 e^{2t} \end{pmatrix}
  \end{split}
\end{equation}



\subsection{Inhomogeneous linear systems}
\noindent\rule[\linienAbstand]{\linewidth}{\linienDicke}
We now discuss the inhomogeneous system
\begin{equation}
  \dot{\mathbf{x}} = A\mathbf{x} + \mathbf{b}t
\end{equation}
with a constant coefficient matrix $A$ and a nonconstant source term $\mathbf{b}(t)$.\\
We will look at the following two methods for obtaining the special solution of the homogeneous system.
\begin{itemize}
  \item Elimination of variables
  \item Using the decomposition $\mathbf{x} = \mathbf{x}_h + \mathbf{x}_s$ and choosing an ansatz for $\mathbf{x}_s$ of a similar type as the source term.
\end{itemize}

\textbf{Elemination of variables}\\
This method can be understood as the inversion of what we've done before. We transform a system of first-order ODE’s into a single ODE of higher order. The method is not recommended for ODE systems of dimension 3 or higher. This method is best explained with an example.\\

We solve the IVP
\begin{equation}
  \begin{split}
    \dot{x}_1 &= 2x_1 - x_2 + 1, \;\;\; x_1(0) = 0\\
    \dot{x}_2 &= -x_1 + 2x_2 - 1, \;\;\; x_2(0) = 1
  \end{split}
\end{equation}
To eliminate $x_2(t)$, we write the first equation of as
\begin{equation}
  x_2 = -\dot{x}_1 + 2x_1 + 1
\end{equation}
If this term and its derivative are plugged into the second equation, we obtain for $x_1$ the second order linear ODE
\begin{equation}
  \ddot{x}_1 -4\dot{x}_1 + 3x_1 + 1 = 0
\end{equation}
This ODE can be solved with the method described before, and one gets the general solution
\begin{equation}
  x_1 = C_1 e^t + C_2 e^{3t} - \frac{1}{3}
\end{equation}
If this solution and its derivative are plugged into the second initial equation, one gets for $x_2$ the general solution
\begin{equation}
  x_2 = C_1 e^t - C_2 e^{3t} + \frac{1}{3}
\end{equation}
Observe that the constants $C_1$ adn $C_2$ have to be the same in both equations. Now the initial conditions can be pluged in, and we obtain the system of equations
\begin{equation}
  \begin{vmatrix}
    C_1 e^t + C_2 - \frac{1}{3} = 0\\
    C_1 - C_2 + \frac{1}{3} = 1
  \end{vmatrix}
\end{equation}
for $C_1$ and $C_2$. The solution of this system is
\begin{equation}
  C_1 = \frac{1}{2}, \;\;\;\;\; C_2 = -\frac{1}{6}
\end{equation}
The IVP thus has the unique solution
\begin{equation}
  \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} =
  \begin{pmatrix}
    \frac{1}{2}e^t - \frac{1}{6}e^{3t} - \frac{1}{3}\\
    \frac{1}{2}e^t + \frac{1}{6}e^{3t} + \frac{1}{3}
  \end{pmatrix}
\end{equation}


\textbf{Choice of an ansatz}\\
As in the scalar case, we choose as ansatz for a special solution $\mathbf{x}_s$ an ansatz of the same type as the source term $\mathbf{g}(t)$ with coefficients which are yet undetermined. These coefficients are then determined by plugging the ansatz into the inhomogeneous system. The choice of a suitable ansatz can be made according to the Table above, if one reads the entries of the table vectorially.\\
Observe that the choice of an ansatz always has to be made globally, and not componentwise: If there are different source terms in the various ODE’s of the system, then these component source terms all have to be taken into account in the choice of the ansatz for $\mathbf{x}_s$.\\

\textbf{Example} (Continuation). Consider the IVP
\begin{equation}
  \begin{split}
    \dot{x}_1 &= 2x_1 - x_2 + 1, \;\;\; x_1(0) = 0\\
    \dot{x}_2 &= -x_1 + 2x_2 - 1, \;\;\; x_2(0) = 1
  \end{split}
\end{equation}
The general solution of the homogeneous system is given by
\begin{equation}
  \mathbf{x}_h = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} =
  C_1 \begin{pmatrix} 1 \\ 1 \end{pmatrix} e^t +
  C_2 \begin{pmatrix} 1 \\ -1\end{pmatrix} e^{3t}
\end{equation}
To find a special solution, we select an ansatz of the type of the source term $\mathbf{b} = \binom{1}{-1}$, i.e. the constant ansatz
\begin{equation}
  \mathbf{x}_p = \begin{pmatrix} A_1 \\ A_2 \end{pmatrix}
\end{equation}
By plugging this ansatz into the initial IVP, we obtain the system of equations
\begin{equation}
  \begin{vmatrix}
    0 &= 2A_1 - A_2 + 1\\
    0 &= -A_1 + 2A_2 - 1
  \end{vmatrix}
\end{equation}
hence
\begin{equation}
  A_1 = -\frac{1}{3}, \;\;\;\;\;\; A_2 = \frac{1}{3}
\end{equation}
and thus the special solution
\begin{equation}
  \mathbf{x}_s(t) = \frac{1}{3} \begin{pmatrix} -1 \\ 1 \end{pmatrix}
\end{equation}
Combining $\mathbf{x}_h$ and $\mathbf{x}_s$, this leads to the general solution
\begin{equation}
  \begin{pmatrix} x_1(t) \\ x_2(t) \end{pmatrix} =
  C_1 \begin{pmatrix} 1 \\ 1 \end{pmatrix} e^t +
  C_2 \begin{pmatrix} 1 \\ -1\end{pmatrix} e^{3t} +
  \frac{1}{3} \begin{pmatrix} -1 \\ 1 \end{pmatrix}
\end{equation}
To solve the IVP we plug in the initial conditions into the general solution and get the same solution as above.
